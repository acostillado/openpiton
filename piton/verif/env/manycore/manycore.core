CAPI=2:
name: openpiton::manycore_tb:0.1
description: manycore testbench

filesets:
    tb_files:
        depend:
            - openpiton::piton_include
            - openpiton::piton_chipset_include
            - openpiton::system
            - openpiton::piton_dpi
            - tool_verilator? (openpiton::verilator_top)
        files:
            - cmp_pcxandcpx.v
            - exu_mon.v
            - fake_pll.v
            - icache_mutex_mon.v
#            - iob_mon.v
            - l_cache_mon.v
            - mask_mon.v
            - nc_inv_chk.v
            - nukeint_mon.v
            - pc_muxsel_mon.v
            - sas_intf.v
            - sas_task.v
            - softint_mon.v
            - sparc_pipe_flow.v
            - stb_ovfl_mon.v
            - thrfsm_mon.v
            - tlu_mon.v
            - fake_uart.v
            - ../common/fake_mem_ctrl.v: {file_type: systemVerilogSource}
        file_type: verilogSource-2001

    s10gx_vcs_ip:
        files:
            - ../../../design/intel/s10gx/ip/clk_mmcm/clk_mmcm_clock_in/sim/clk_mmcm_clock_in.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_csr.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_bit_timer.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_clkgen.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_csrext.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_data_cnt.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_databuffer.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_fifo.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_fifomem.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_interrupt.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_modem.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_rx_shift.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_rx_sync.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_rxfc.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_rxfsm.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_rxin.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_rxstor.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_rxswfc.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_sync.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_tx_shift.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_txfc.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_txfsm.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_txout.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_txstor.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altera_16550_uart.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/altera_16550_uart_1912/sim/synopsys/altr_uart_dmaintf.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_a_16550_uart_0/sim/uart_a_16550_uart_0.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_axi_bridge_0/altera_axi_bridge_1931/sim/uart_axi_bridge_0_altera_axi_bridge_1931_wohh45y.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_axi_bridge_0/altera_axi_bridge_1931/sim/altera_avalon_st_pipeline_base.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_axi_bridge_0/sim/uart_axi_bridge_0.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_clock_in/sim/uart_clock_in.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/ip/uart/uart_reset_in/sim/uart_reset_in.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/clk_mmcm/sim/clk_mmcm.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_slave_translator_191/sim/uart_altera_merlin_slave_translator_191_x56fcki.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_axi_master_ni_1940/sim/altera_merlin_address_alignment.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_axi_master_ni_1940/sim/uart_altera_merlin_axi_master_ni_1940_xmlitzq.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_slave_agent_191/sim/uart_altera_merlin_slave_agent_191_ncfkfri.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_slave_agent_191/sim/altera_merlin_burst_uncompressor.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_avalon_sc_fifo_1931/sim/uart_altera_avalon_sc_fifo_1931_vhmcgqy.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_router_1921/sim/uart_altera_merlin_router_1921_wu6uqgi.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_router_1921/sim/uart_altera_merlin_router_1921_zjyjhoa.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_demultiplexer_1921/sim/uart_altera_merlin_demultiplexer_1921_ekfzhji.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_multiplexer_1921/sim/uart_altera_merlin_multiplexer_1921_qjqmo2a.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_multiplexer_1921/sim/altera_merlin_arbitrator.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_demultiplexer_1921/sim/uart_altera_merlin_demultiplexer_1921_xu5xrea.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_multiplexer_1921/sim/uart_altera_merlin_multiplexer_1921_cz47psq.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_merlin_multiplexer_1921/sim/altera_merlin_arbitrator.sv : {file_type : systemVerilogSource}
            - ../../../design/intel/s10gx/uart/altera_mm_interconnect_1920/sim/uart_altera_mm_interconnect_1920_ppouvcq.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/uart/altera_reset_controller_1921/sim/altera_reset_controller.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/uart/altera_reset_controller_1921/sim/altera_reset_synchronizer.v : {file_type : verilogSource}
            - ../../../design/intel/s10gx/uart/sim/uart.v : {file_type : verilogSource}

targets:
    sim:
        default_tool: icarus
        filesets:
            - tb_files
        generate: [pyhp_preprocess]
        toplevel: [cmp_top]
        tools:
            verilator:
                verilator_options:
                    - -j
                    - -Wno-fatal
                    - -Wno-BLKANDNBLK
                    - -Wno-TIMESCALEMOD
                    - --unroll-count 256
                    - -CFLAGS -DPITON_DPI
                    - -CFLAGS -DVERILATOR
                    - -CFLAGS -lstdc++
            vcs:
                vcs_options:
                    - +nospecify
                    - -Xstrict=1
                    - -notice
                    - -timescale=1ps/1ps
                    - +rad
                    - debug_all? (-debug_all)
                    - ariane? (-sverilog)
                    - ariane? (+systemverilogext+.sv)
                    - ariane? (-ntb_opts uvm-1.1 +vpi)
                    - -P
                    - $DV_ROOT/tools/pli/iop/bwioj.tab
                    - -P
                    - $DV_ROOT/tools/pli/socket/bwsocket_pli.tab
                    - -P
                    - $DV_ROOT/tools/pli/mem/bwmem_pli.tab
                    - -lsocket_pli
                    - -liob
                    - -lmem_pli
                    - +lint=all,noVCDE,noVNGS,noPCTIO-L,noPCTIO
                    - +warn=all
                    - -l compile.log
            icarus:
                iverilog_options: [-g2001]
            modelsim:
                vlog_options:
                    - -mfcu
                    - -suppress 2583
            xcelium:
                xrun_options:
                    - -64bit
                    - -dpi
                    - -disable_sem2009
                    - -override_timescale
                    - -timescale 1ps/1ps
                    - -sv_lib $MODEL_DIR/piton_dpi
                    - ariane? (-uvm)
                    - ariane? (-uvmhome CDNS-1.2)
        parameters:
            - tool_vcs? (OST1_PLI_SLAM_RANDOM=true)
            - tool_vcs? (OST1_PLI_MRA_VAL=true)
            - tool_rivierapro? (OST1_PLI_SLAM_RANDOM=true)
            - tool_rivierapro? (OST1_PLI_MRA_VAL=true)
            - ost1? (PITON_OST1=true)
            - pico? (PITON_PICO=true)
            - pico_het? (PITON_PICO=true)
            - pico_het? (PITON_PICO_HET=true)
            - ariane? (PITON_ARIANE=true)
            - ariane? (WT_DCACHE=true)
            - tool_xcelium? (PITON_DPI=true)
            - tool_verilator? (PITON_DPI=true)
            - tool_verilator? (SYNC_MUX=true)
            - oram? (ORAM_ON=true)
            - oram? (oram=true)
            - ibm? (IBM_SRAM_RF16X160_MODEL_CHECKER=true)
            - ibm? (IBM_SRAM_RF32X80_MODEL_CHECKER=true)
            - ibm? (IBM_SRAM_CACHE_TAG_MODEL_CHECKER=true)
            - ibm? (IBM_SRAM_LSU_ICACHE_MODEL_CHECKER=true)
    pickle:
        default_tool: icarus
        filesets: [tb_files]
        generate: [pyhp_preprocess]
        toplevel: [cmp_top]
        tools:
            icarus:
                iverilog_options: [-g 2001 -E]
    s10gx:
        default_tool: vcs
        filesets:
          - tb_files
          - tool_vcs? (s10gx_vcs_ip)
        generate: [pyhp_preprocess]
        toplevel: [cmp_top]
        tools:
          vcs:
              vcs_options:
                  - "-LDFLAGS -Wl,--no-as-needed"
                  - +nospecify
                  - -Xstrict=1
                  - -notice
                  - -timescale=1ps/1ps
                  - +rad
                  - -sverilog
                  - +systemverilogext+.sv
                  - "-ntb_opts uvm-1.1 +vpi"
                  - "-L/home/jbalkind/Documents/projects/openpiton/intel/piton/tools/Linux/x86_64/lib"
                  - "-P /home/jbalkind/Documents/projects/openpiton/intel/piton/tools/pli/iop/bwioj.tab"
                  - "-P /home/jbalkind/Documents/projects/openpiton/intel/piton/tools/pli/socket/bwsocket_pli.tab"
                  - "-P /home/jbalkind/Documents/projects/openpiton/intel/piton/tools/pli/mem/bwmem_pli.tab"
                  - -lsocket_pli
                  - -liob
                  - -lmem_pli
                  - +lint=all,noVCDE,noVNGS,noPCTIO-L,noPCTIO
                  - +warn=all
                  - -l compile.log
                  - "-v /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/altera_primitives.v"
                  - "-v /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/220model.v"
                  - "-v /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/sgate.v"
                  - "-v /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/altera_mf.v"
                  - /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/altera_lnsim.sv
                  - /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/fourteennm_atoms.sv
                  - /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/synopsys/fourteennm_atoms_ncrypt.sv
                  - /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/ct1_hssi_atoms.sv
                  - /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/ct1_hssi_atoms_ncrypt.sv
                  - /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/ct1_hip_atoms.sv
                  - /tools/intel/intelFPGA_pro/22.3/quartus//eda/sim_lib/ct1_hip_atoms_ncrypt.sv
                  #- -debug_all
        parameters:
            - NO_SCAN=true
            - FPGA_SYN=true
            - PITON_FPGA_SYNTH=true
            - PITON_PROTO=true
            - ost1? (PITON_OST1=true)
            - ariane? (PITON_ARIANE=true)
            - ariane? (WT_DCACHE=true)
            - PITON_FULL_SYSTEM=true
            - PITON_FPGA_NO_DMBR=true
            #- CONFIG_DISABLE_BIST_CLEAR=true
            - ariane? (NO_RTL_CSM=true)
            - PITON_NO_CHIP_BRIDGE=true
            - INTEL_S10GX_BOARD=true
            - PITON_UART16550=true
            - PITON_FPGA_BRAM_BOOT=true
            - PITONSYS_NO_MC=true
            - MINIMAL_MONITORING=true
            - L2_SEND_NC_REQ=true
parameters:
    NO_SCAN:
        datatype: bool
        default: true
        paramtype: vlogdefine
    SYNC_MUX:
        datatype: bool
        paramtype: vlogdefine
    USE_FAKE_PLL_AND_CLKMUX:
        datatype: bool
        default: true
        paramtype: vlogdefine
    USE_FAKE_IOS:
        datatype: bool
        default: true
        paramtype: vlogdefine
    OST1_PLI_SLAM_RANDOM:
        datatype: bool
        paramtype: vlogdefine
    OST1_PLI_MRA_VAL:
        datatype: bool
        paramtype: vlogdefine
    FPGA_SYN:
        datatype: bool
        paramtype: vlogdefine
    PITON_FPGA_SYNTH:
        datatype: bool
        paramtype: vlogdefine
    PITON_FULL_SYSTEM:
        datatype: bool
        paramtype: vlogdefine
    PITON_PROTO:
        datatype: bool
        paramtype: vlogdefine
    PITON_FPGA_NO_DMBR:
        datatype: bool
        paramtype: vlogdefine
    CONFIG_DISABLE_BIST_CLEAR:
        datatype: bool
        paramtype: vlogdefine
    NO_RTL_CSM:
        datatype: bool
        paramtype: vlogdefine
    PITONSYS_NO_MC:
        datatype: bool
        paramtype: vlogdefine
    PITON_FPGA_BRAM_BOOT:
        datatype: bool
        paramtype: vlogdefine
    PITON_NO_CHIP_BRIDGE:
        datatype: bool
        paramtype: vlogdefine
    PITON_UART16550:
        datatype: bool
        paramtype: vlogdefine
    PITON_OST1:
        datatype: bool
        paramtype: vlogdefine
    PITON_PICO:
        datatype: bool
        paramtype: vlogdefine
    PITON_PICO_HET:
        datatype: bool
        paramtype: vlogdefine
    PITON_ARIANE:
        datatype: bool
        paramtype: vlogdefine
    WT_DCACHE:
        datatype: bool
        paramtype: vlogdefine
    PITON_DPI:
        datatype: bool
        paramtype: vlogdefine
    ORAM_ON:
        datatype: bool
        paramtype: vlogdefine
    oram:
        datatype: bool
        paramtype: plusarg
    IBM_SRAM_RF16X160_MODEL_CHECKER:
        datatype: bool
        paramtype: vlogdefine
    IBM_SRAM_RF32X80_MODEL_CHECKER:
        datatype: bool
        paramtype: vlogdefine
    IBM_SRAM_CACHE_TAG_MODEL_CHECKER:
        datatype: bool
        paramtype: vlogdefine
    IBM_SRAM_LSU_ICACHE_MODEL_CHECKER:
        datatype: bool
        paramtype: vlogdefine
    INTEL_S10GX_BOARD:
        datatype: bool
        paramtype: vlogdefine
    MINIMAL_MONITORING:
        datatype: bool
        paramtype: vlogdefine
    L2_SEND_NC_REQ:
        datatype: bool
        paramtype: vlogdefine

generate:
    pyhp_preprocess:
        generator: pyhp_preprocess_gen
        parameters:
            process_me : [[cross_module.h.pyv, cross_module.tmp.h],
                          [manycore_top.v.pyv, manycore_top.tmp.v],
                          [async_fifo_mon.v.pyv, async_fifo_mon.tmp.v],
                          [ciop_iob.v.pyv, ciop_iob.tmp.v],
                          [cmp_l15_messages_mon.v.pyv, cmp_l15_messages_mon.tmp.v],
                          [dmbr_mon.v.pyv, dmbr_mon.tmp.v],
                          [jtag_mon.v.pyv, jtag_mon.tmp.v],
                          [l2_mon.v.pyv, l2_mon.tmp.v],
                          [lsu_mon.v.pyv, lsu_mon.tmp.v],
                          [lsu_mon2.v.pyv, lsu_mon2.tmp.v],
                          [manycore_network_mon.v.pyv, manycore_network_mon.tmp.v],
                          [monitor.v.pyv, monitor.tmp.v],
                          [multicycle_mon.v.pyv, multicycle_mon.tmp.v],
                          [pc_cmp.v.pyv, pc_cmp.tmp.v],
                          [sas_tasks.v.pyv, sas_tasks.tmp.v],
                          [slam_init.v.pyv, slam_init.tmp.v],
                          [tso_mon.v.pyv, tso_mon.tmp.v]]
